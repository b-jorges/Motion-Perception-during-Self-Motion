1.3*6.6
0.7*6.6
0.7*6.6*0.5
0.7*6.6*0.7
timeseries = seq(0,0.5,0.01)
pnorm(timeseries, mean = 0.25, sd = 0.08)
dnorm(timeseries, mean = 0.25, sd = 0.08)
plot(timeseries,pnorm(timeseries, mean = 0.25, sd = 0.08))
plot(timeseries,dnorm(timeseries, mean = 0.25, sd = 0.08))
plot(timeseries,pnorm(timeseries, mean = 0.25, sd = 0.08))
###Pull the whole repository and paste the path to the the local GitHub repository here:
setwd("C:/Users/bjoer/Documents/GitHub/Motion-Perception-during-Self-Motion")
require(ggplot2)
require(dplyr)
require(lme4)
source("parabolic.r")
source("functions.r")
source("colourschemes.r")
require(tidyverse)
require(quickpsy)
require(cowplot)
require(MixedPsy)
theme_set(theme_cowplot())
b <- read.table(header=T,"PilotLaurence.txt")
c <- read.table(header=T,"PilotBjorn_2D.txt")
d <- read.table(header=T,"PilotBjorn_3D.txt")
e <- read.table(header=T,"PilotMeaghan.txt")
f <- read.table(header=T,"PilotLaurence2.txt")
g <- read.table(header=T,"PilotRachel.txt")
h <- read.table(header=T,"PilotAbi.txt")
i <- read.table(header=T,"PilotJohn.txt")
j <- read.table(header=T,"PilotJohn.txt")
b$id = "Laurence"
c$id = "Bjorn"
d$id = "Bjorn2"
e$id = "Meaghan"
b$Start_Above = 1
c$Start_Above = 1
f$id = "Laurence2"
g$id = "Rachel"
h$id = "Abi"
i$id = "John"
j$id = "Bob"
a = rbind(b,c,d,e,f,g,h,i,j)
a = a %>%
mutate(
Pest_Bigger = case_when(
Response_Interval == Pest_Interval ~ 1,
Response_Interval != Pest_Interval ~ 0,
),
Direction = case_when(
velH < 0 ~ "left",
velH > 0 ~ "right",
),
Difference = abs(velH_Pest)-abs(velH),
velH_Absolut = abs(velH),
Congruent = case_when(
velH*velH_Subject < 0 ~ "incongruent",
velH*velH_Subject > 0 ~ "congruent",
velH*velH_Subject == 0 ~ "1no motion"
),
Difference_Percent = Difference/velH
) %>%
filter(abs(velH_Pest) < abs(velH)*1.5)
a = a %>%
group_by(id,Congruent,velH,Difference) %>%
mutate(Yes = sum(Pest_Bigger==1),
Total = length(velH_Subject))
Data_GLM =
select(a,c(id,Congruent,velH,Difference,Yes,Total,velH_Subject)) %>%
distinct()
Data_GLM = Data_GLM %>%
mutate(
Static = case_when(
velH_Subject == 0 ~ 1,
velH_Subject != 0 ~ 0
)
)
ggplot(a[a$id %in% c("Meaghan", "Bjorn2", "Laurence2", "John", "Abi", "Bob"),], aes ( x = Difference, y = Pest_Bigger, col = as.factor(Congruent))) +
binomial_smooth() +
facet_grid(id~velH)
ggplot(PSEsJNDs[PSEsJNDs$parn == "p1",], aes(Congruent2,par, fill = Congruent2)) +
geom_bar(stat="identity",color="black") +
facet_grid(id~velH) +
ylab(label = "PSEs (m/s)") +
xlab(label = "") +
ggtitle(label = "PSE") +
scale_x_discrete(labels = c('incongruent','no motion','congruent')) +
theme(legend.position = "none")
lala10 = quickpsy(a[a$id %in% c("Meaghan", "Bjorn2", "Laurence2", "John", "Abi", "Bob"),], Difference, Pest_Bigger, grouping = .(id,Congruent,velH))
PSEsJNDs = data.frame(lala10$par)
PSEsJNDs = PSEsJNDs %>%
mutate(Congruent2 =
case_when(
Congruent == "incongruent" ~ "1incongruent",
Congruent =="congruent" ~ "3congruent",
Congruent =="1no motion" ~ "2no motion"
)
)
QuickPsyCurves = lala10$curves
ggplot(QuickPsyCurves, aes(x, y, color = Congruent)) +
geom_line() +
coord_cartesian(xlim = c(-5,1)) +
facet_grid(id~velH)
ggplot(PSEsJNDs[PSEsJNDs$parn == "p1",], aes(Congruent2,par, fill = Congruent2)) +
geom_bar(stat="identity",color="black") +
facet_grid(id~velH) +
ylab(label = "PSEs (m/s)") +
xlab(label = "") +
ggtitle(label = "PSE") +
scale_x_discrete(labels = c('incongruent','no motion','congruent')) +
theme(legend.position = "none")
ggplot(PSEsJNDs[PSEsJNDs$parn == "p2",], aes(Congruent2,par, fill = Congruent2)) +
geom_bar(stat="identity",color="black") +
facet_grid(id~velH) +
ylab(label = "SD (m/s)") +
xlab(label = "") +
ggtitle(label = "Thresholds") +
scale_x_discrete(labels = c('incongruent','no motion','congruent')) +
theme(legend.position = "none")
PSEsJNDs = PSEsJNDs %>%
group_by(Congruent, parn) %>%
mutate(mean = mean(par),
SD = sd(par),
n = length(par),
SE = SD_PSE/(n_PSE)^0.5)
ggplot(PSEsJNDs[PSEsJNDs$parn == "p1" & PSEsJNDs$velH == 6.6 & PSEsJNDs$id == "Laurence2",], aes(Congruent2,mean, fill = Congruent2)) +
geom_bar(stat="identity",color="black") +
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE),
size=.3,    # Thinner lines
width=.3,
position=position_dodge(.9)) +
ylab(label = "PSEs (m/s)") +
xlab(label = "") +
ggtitle(label = "PSE") +
scale_x_discrete(labels = c('incongruent','no motion','congruent')) +
theme(legend.position = "none")
ggplot(PSEsJNDs[PSEsJNDs$parn == "p2" & PSEsJNDs$velH == 6.6 & PSEsJNDs$id == "Laurence2",], aes(Congruent2,mean, fill = Congruent2)) +
geom_bar(stat="identity",color="black") +
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE),
size=.3,    # Thinner lines
width=.3,
position=position_dodge(.9)) +
ylab(label = "SD (m/s)") +
xlab(label = "") +
ggtitle(label = "Thresholds") +
scale_x_discrete(labels = c('incongruent','no motion','congruent')) +
theme(legend.position = "none")
PSEsJNDs = PSEsJNDs %>%
group_by(Congruent, parn) %>%
mutate(mean = mean(par),
SD = sd(par),
n = length(par),
SE = SD/(n)^0.5)
ggplot(PSEsJNDs[PSEsJNDs$parn == "p1" & PSEsJNDs$velH == 6.6 & PSEsJNDs$id == "Laurence2",], aes(Congruent2,mean, fill = Congruent2)) +
geom_bar(stat="identity",color="black") +
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE),
size=.3,    # Thinner lines
width=.3,
position=position_dodge(.9)) +
ylab(label = "PSEs (m/s)") +
xlab(label = "") +
ggtitle(label = "PSE") +
scale_x_discrete(labels = c('incongruent','no motion','congruent')) +
theme(legend.position = "none")
ggplot(PSEsJNDs[PSEsJNDs$parn == "p2" & PSEsJNDs$velH == 6.6 & PSEsJNDs$id == "Laurence2",], aes(Congruent2,mean, fill = Congruent2)) +
geom_bar(stat="identity",color="black") +
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE),
size=.3,    # Thinner lines
width=.3,
position=position_dodge(.9)) +
ylab(label = "SD (m/s)") +
xlab(label = "") +
ggtitle(label = "Thresholds") +
scale_x_discrete(labels = c('incongruent','no motion','congruent')) +
theme(legend.position = "none")
PSEsJNDsWithLaurence = PSEsJNDs
PSEsJNDs = PSEsJNDs %>%
filter(PSEsJNDs, id != "Laurence2") %>%
group_by(Congruent, parn) %>%
mutate(mean = mean(par),
SD = sd(par),
n = length(par),
SE = SD/(n)^0.5)
PSEsJNDsWithLaurence = PSEsJNDs
PSEsJNDsWithLaurence
PSEsJNDs = PSEsJNDs %>%
filter(PSEsJNDs, id != "Laurence2") %>%
group_by(Congruent, parn) %>%
mutate(mean = mean(par),
SD = sd(par),
n = length(par),
SE = SD/(n)^0.5)
PSEsJNDs$id
PSEsJNDs$id
PSEsJNDs
PSEsJNDs = PSEsJNDs %>%
filter(PSEsJNDs, id != "Laurence2") %>%
group_by(Congruent, parn) %>%
mutate(mean = mean(par),
SD = sd(par),
n = length(par),
SE = SD/(n)^0.5)
PSEsJNDs %>%
filter(PSEsJNDs, id != "Laurence2")
PSEsJNDs %>%
filter(PSEsJNDs, id == "Laurence2")
PSEsJNDs %>%
filter(PSEsJNDs, id = "Laurence2")
PSEsJNDs %>%
filter(PSEsJNDs, id == "Laurence2")
PSEsJNDs = PSEsJNDs %>%
filter(PSEsJNDs, par < 1) %>%
group_by(Congruent, parn) %>%
mutate(mean = mean(par),
SD = sd(par),
n = length(par),
SE = SD/(n)^0.5)
PSEsJNDs
PSEsJNDs %>%
filter(PSEsJNDs, velH == 8)
PSEsJNDs = PSEsJNDs %>%
filter(id != "Laurence2") %>%
group_by(Congruent, parn) %>%
mutate(mean = mean(par),
SD = sd(par),
n = length(par),
SE = SD/(n)^0.5)
ggplot(PSEsJNDs[PSEsJNDs$parn == "p2" & PSEsJNDs$velH == 6.6 & PSEsJNDs$id == "Laurence2",], aes(Congruent2,mean, fill = Congruent2)) +
geom_bar(stat="identity",color="black") +
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE),
size=.3,    # Thinner lines
width=.3,
position=position_dodge(.9)) +
ylab(label = "SD (m/s)") +
xlab(label = "") +
ggtitle(label = "Thresholds") +
scale_x_discrete(labels = c('incongruent','no motion','congruent')) +
theme(legend.position = "none")
ggplot(PSEsJNDs[PSEsJNDs$parn == "p2" & PSEsJNDs$velH == 6.6 & PSEsJNDs$id == "Meaghan",], aes(Congruent2,mean, fill = Congruent2)) +
geom_bar(stat="identity",color="black") +
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE),
size=.3,    # Thinner lines
width=.3,
position=position_dodge(.9)) +
ylab(label = "SD (m/s)") +
xlab(label = "") +
ggtitle(label = "Thresholds") +
scale_x_discrete(labels = c('incongruent','no motion','congruent')) +
theme(legend.position = "none")
ggplot(PSEsJNDs[PSEsJNDs$parn == "p1" & PSEsJNDs$velH == 6.6 & PSEsJNDs$id == "Laurence2",], aes(Congruent2,mean, fill = Congruent2)) +
geom_bar(stat="identity",color="black") +
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE),
size=.3,    # Thinner lines
width=.3,
position=position_dodge(.9)) +
ylab(label = "PSEs (m/s)") +
xlab(label = "") +
ggtitle(label = "PSE") +
scale_x_discrete(labels = c('incongruent','no motion','congruent')) +
theme(legend.position = "none")
ggplot(PSEsJNDs[PSEsJNDs$parn == "p1" & PSEsJNDs$velH == 6.6 & PSEsJNDs$id == "Meaghan",], aes(Congruent2,mean, fill = Congruent2)) +
geom_bar(stat="identity",color="black") +
geom_errorbar(aes(ymin=mean-SE, ymax=mean+SE),
size=.3,    # Thinner lines
width=.3,
position=position_dodge(.9)) +
ylab(label = "PSEs (m/s)") +
xlab(label = "") +
ggtitle(label = "PSE") +
scale_x_discrete(labels = c('incongruent','no motion','congruent')) +
theme(legend.position = "none")
