1.3*6.6
0.7*6.6
0.7*6.6*0.5
0.7*6.6*0.7
timeseries = seq(0,0.5,0.01)
pnorm(timeseries, mean = 0.25, sd = 0.08)
dnorm(timeseries, mean = 0.25, sd = 0.08)
plot(timeseries,pnorm(timeseries, mean = 0.25, sd = 0.08))
plot(timeseries,dnorm(timeseries, mean = 0.25, sd = 0.08))
plot(timeseries,pnorm(timeseries, mean = 0.25, sd = 0.08))
rmarkdown::render_site()
plot(cars)
package.report0 = as.matrix(installed.packages())  #all packages installed
package.report1=package.report0[,c(1,3,16)]             #relevant columns
write.table(package.report1, "clipboard", sep="\t", row.names=FALSE)  #copies to clipboard
cat("\n\n\nHEY!, the list is in your clipboard already; go to your browser and just paste it in the survey")
###Pull the whole repository
# Where is this script?
Where_Am_I <- function(path=T){
if (path == T){
dirname(rstudioapi::getSourceEditorContext()$path)
}
else {
rstudioapi::getSourceEditorContext()$path
}
}
setwd(Where_Am_I())
###Pull the whole repository and paste the path to the the local GitHub repository here:
setwd("C:/Users/bjoer/Documents/GitHub/Motion-Perception-during-Self-Motion")
require(ggplot2)
require(dplyr)
require(lme4)
source("parabolic.r")
source("functions.r")
source("colourschemes.r")
require(tidyverse)
require(quickpsy)
require(cowplot)
require(MixedPsy)
theme_set(theme_cowplot())
set.seed(81)
levelsFix1 = c("NoMotion+NoMotion","MotionCongruent+NoMotion","MotionIncongruent+NoMotion")
bFix1 = c(1,0.9,1.1) ####this is perceived time to contact/actual time to contact
Intercept = 0
sdSubject = 0.08
sdError = 0.08
nParticipants = 10
nTrials = 210
sdCondition = c(0,1,1)
nIterations = 100
Power_Timing1=c()
Power_Timing2=c()
b <- read.table(header=T,"PilotLaurence.txt")
c <- read.table(header=T,"PilotBjorn_2D.txt")
d <- read.table(header=T,"PilotBjorn_3D.txt")
e <- read.table(header=T,"PilotMeaghan.txt")
f <- read.table(header=T,"PilotLaurence2.txt")
g <- read.table(header=T,"PilotRachel.txt")
h <- read.table(header=T,"PilotAbi.txt")
i <- read.table(header=T,"PilotJohn.txt")
j <- read.table(header=T,"PilotJohn.txt")
b$id = "Laurence"
c$id = "Bjorn"
d$id = "Bjorn2"
e$id = "Meaghan"
b$Start_Above = 1
c$Start_Above = 1
f$id = "Laurence2"
g$id = "Rachel"
h$id = "Abi"
i$id = "John"
j$id = "Bob"
a = rbind(b,c,d,e,f,g,h,i,j)
a = a %>%
mutate(
Pest_Bigger = case_when(
Response_Interval == Pest_Interval ~ 1,
Response_Interval != Pest_Interval ~ 0,
),
Direction = case_when(
velH < 0 ~ "left",
velH > 0 ~ "right",
),
Difference = abs(velH_Pest)-abs(velH),
velH_Absolut = abs(velH),
Congruent = case_when(
velH*velH_Subject < 0 ~ "incongruent",
velH*velH_Subject > 0 ~ "congruent",
velH*velH_Subject == 0 ~ "1no motion"
),
Difference_Percent = Difference/velH
) %>%
filter(abs(velH_Pest) < abs(velH)*1.5)
Data_GLM =
select(a,c(id,Congruent,velH,Difference,Yes,Total,velH_Subject)) %>%
distinct()
Data_GLM = Data_GLM %>%
mutate(
Static = case_when(
velH_Subject == 0 ~ 1,
velH_Subject != 0 ~ 0
)
)
mod1 = glmer(cbind(Yes, Total - Yes) ~ Congruent + (Difference | id) + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
mod2 = glmer(cbind(Yes, Total - Yes) ~ (Difference | id)  + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
mod3 = glmer(cbind(Yes, Total - Yes) ~ Congruent*Difference + (Difference | id) + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
mod4 = glmer(cbind(Yes, Total - Yes) ~ Congruent + Difference + (Difference | id)  + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
a = a %>%
group_by(id,Congruent,velH,Difference) %>%
mutate(Yes = sum(Pest_Bigger==1),
Total = length(velH_Subject))
Data_GLM =
select(a,c(id,Congruent,velH,Difference,Yes,Total,velH_Subject)) %>%
distinct()
Data_GLM = Data_GLM %>%
mutate(
Static = case_when(
velH_Subject == 0 ~ 1,
velH_Subject != 0 ~ 0
)
)
mod1 = glmer(cbind(Yes, Total - Yes) ~ Congruent + (Difference | id) + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
mod2 = glmer(cbind(Yes, Total - Yes) ~ (Difference | id)  + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
mod3 = glmer(cbind(Yes, Total - Yes) ~ Congruent*Difference + (Difference | id) + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
mod4 = glmer(cbind(Yes, Total - Yes) ~ Congruent + Difference + (Difference | id)  + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
anova(mod1,mod2)
anova(mod4,mod3)
anova(mod4,mod3)
summary(mod3)
anova(mod1,mod2)
summary(mod3)
anova(mod1,mod2)
summary(mod1)
b <- read.table(header=T,"PilotData/PilotLaurence.txt")
c <- read.table(header=T,"PilotData/PilotBjorn_2D.txt")
d <- read.table(header=T,"PilotData/PilotBjorn_3D.txt")
e <- read.table(header=T,"PilotData/PilotMeaghan.txt")
f <- read.table(header=T,"PilotData/PilotLaurence2.txt")
g <- read.table(header=T,"PilotData/PilotRachel.txt")
h <- read.table(header=T,"PilotData/PilotAbi.txt")
i <- read.table(header=T,"PilotData/PilotJohn.txt")
j <- read.table(header=T,"PilotData/PilotBob.txt")
b$id = "Laurence"
c$id = "Bjorn"
d$id = "Bjorn2"
e$id = "Meaghan"
b$Start_Above = 1
c$Start_Above = 1
f$id = "Laurence2"
g$id = "Rachel"
h$id = "Abi"
i$id = "John"
j$id = "Bob"
a = rbind(b,c,d,e,f,g,h,i,j)
a = a %>%
mutate(
Pest_Bigger = case_when(
Response_Interval == Pest_Interval ~ 1,
Response_Interval != Pest_Interval ~ 0,
),
Direction = case_when(
velH < 0 ~ "left",
velH > 0 ~ "right",
),
Difference = abs(velH_Pest)-abs(velH),
velH_Absolut = abs(velH),
Congruent = case_when(
velH*velH_Subject < 0 ~ "incongruent",
velH*velH_Subject > 0 ~ "congruent",
velH*velH_Subject == 0 ~ "1no motion"
),
Difference_Percent = Difference/velH
) %>%
filter(abs(velH_Pest) < abs(velH)*1.5)
a = a %>%
group_by(id,Congruent,velH,Difference) %>%
mutate(Yes = sum(Pest_Bigger==1),
Total = length(velH_Subject))
Data_GLM =
select(a,c(id,Congruent,velH,Difference,Yes,Total,velH_Subject)) %>%
distinct()
Data_GLM = Data_GLM %>%
mutate(
Static = case_when(
velH_Subject == 0 ~ 1,
velH_Subject != 0 ~ 0
)
)
ggplot(a[a$id %in% c("Meaghan", "Bjorn2", "Laurence2", "John", "Abi", "Bob"),], aes ( x = Difference, y = Pest_Bigger, col = as.factor(Congruent))) +
binomial_smooth() +
facet_grid(id~velH)
ggplot(a[a$id %in% c("Meaghan", "Bjorn2", "Laurence2", "John", "Abi", "Bob"),], aes ( x = Difference, y = Pest_Bigger, col = as.factor(Congruent))) +
binomial_smooth() +
facet_grid(id~velH)
mod1 = glmer(cbind(Yes, Total - Yes) ~ Congruent + (Difference | id) + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
mod2 = glmer(cbind(Yes, Total - Yes) ~ (Difference | id)  + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
mod3 = glmer(cbind(Yes, Total - Yes) ~ Congruent*Difference + (Difference | id) + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
mod4 = glmer(cbind(Yes, Total - Yes) ~ Congruent + Difference + (Difference | id)  + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob"),])
coef(mod1)
anova(mod1,mod2)
anova(mod4,mod3)
summary(mod3)
anova(mod1,mod2)
summary(mod1)
ggsave("PlotsPilotData", w=10, h=10)
ggsave("PlotsPilotData.jpg", w=10, h=10)
anova(mod1,mod2)
anova(mod4,mod3)
summary(mod3)
coef(mod1)
summary(mod1)
mod1 = glmer(cbind(Yes, Total - Yes) ~ Congruent + (Difference | id) + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob", "Laurence"),])
mod2 = glmer(cbind(Yes, Total - Yes) ~ (Difference | id)  + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob", "Laurence"),])
mod3 = glmer(cbind(Yes, Total - Yes) ~ Congruent*Difference + (Difference | id) + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob", "Laurence"),])
mod4 = glmer(cbind(Yes, Total - Yes) ~ Congruent + Difference + (Difference | id)  + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob", "Laurence"),])
summary(mod1)
coef(mod1)
anova(mod1,mod2)
summary(mod3)
anova(mod4,mod3)
#####Plot data raw data for all subjects included in analysis
ggplot(a[a$id %in% c("Meaghan", "Bjorn2", "John", "Abi", "Bob", "Laurence2"),], aes ( x = Difference, y = Pest_Bigger, col = as.factor(Congruent))) +
binomial_smooth() +
facet_grid(id~velH)
ggplot(a[a$id %in% c("Meaghan", "Bjorn2", "John", "Abi", "Bob", "Laurence2"),], aes ( x = Difference, y = Pest_Bigger, col = as.factor(Congruent))) +
binomial_smooth() +
facet_grid(id~velH)
ggsave("PlotsPilotData.jpg", w=10, h=10)
mod1 = glmer(cbind(Yes, Total - Yes) ~ Congruent + (Difference | id) + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob", "Laurence2"),])
mod2 = glmer(cbind(Yes, Total - Yes) ~ (Difference | id)  + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob", "Laurence2"),])
mod3 = glmer(cbind(Yes, Total - Yes) ~ Congruent*Difference + (Difference | id) + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob", "Laurence2"),])
mod4 = glmer(cbind(Yes, Total - Yes) ~ Congruent + Difference + (Difference | id)  + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob", "Laurence"),])
summary(mod1)
coef(mod1)
anova(mod1,mod2)
summary(mod3)
anova(mod4,mod3)
mod4 = glmer(cbind(Yes, Total - Yes) ~ Congruent + Difference + (Difference | id)  + (Difference | velH),
family = binomial(link = "probit"),
data = Data_GLM[Data_GLM$id %in% c("Meaghan", "Bjorn2", "Abi", "John", "Bob", "Laurence2"),])
anova(mod1,mod2)
coef(mod1)
summary(mod1)
summary(mod3)
anova(mod4,mod3)
summary(mod1)
summary(mod3)
summary(mod1)
